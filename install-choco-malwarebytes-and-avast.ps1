# Install stuff remotely on choco boxes that are servers

import-module ActiveDirectory

$Computers = Get-ADComputer -Filter {OperatingSystem -Like "Windows Server*"} | Select-Object -ExpandProperty Name


Invoke-Command -ComputerName $Computers -ScriptBlock {

    choco install avastfreeantivirus -y | Out-File -FilePath C:\Windows\Temp\choco-avast.txt

    if ($?) {

        Write-Output "$Env:COMPUTERNAME Avast - Successful"

    }

    else {

        Write-Output "$Env:COMPUTERNAME Avast - Failed"

    }

    choco install malwarebytes --ignore-checksum -y | Out-File -FilePath C:\Windows\Temp\choco-malwarebytes.txt

    if ($?) {

        Write-Output "$Env:COMPUTERNAME Malwarebytes - Successful"

    }

    else {

        Write-Output "$Env:COMPUTERNAME Malwarebytes - Failed"

    }

    choco install urbackup-client -y | Out-File -FilePath C:\Windows\Temp\choco-urbackup-client.txt

    if ($?) {

        Write-Output "$Env:COMPUTERNAME urBackup - Successful"

    }

    else {

        Write-Output "$Env:COMPUTERNAME UrBackup - Failed"

    }
    choco install googlechrome -y | Out-File -FilePath C:\Windows\Temp\choco-chrome-client.txt

    if ($?) {

        Write-Output "$Env:COMPUTERNAME urBackup - Successful"

    }

    else {

        Write-Output "$Env:COMPUTERNAME UrBackup - Failed"

    }
}